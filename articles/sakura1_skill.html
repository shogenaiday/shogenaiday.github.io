<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../css/articles.css" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3736712246700193"
       crossorigin="anonymous"></script>
    <title>サクラエディタで1行目をファイル名にして保存する方法</title>
   </head>
<body>
    <h1>サクラエディタで1行目をファイル名にして保存する方法</h1>
    <img src="../assets/images/sakura1_skill.png" alt="イメージ画像" width="600">
    
    <h2>実現したいこと</h2>
    <p>「Ctrl+S」でテキストファイルを保存する際に、<strong>「日付＋1行目の文字列.txt」</strong>という形式のファイル名で保存できるようにします。</p>
    
    <h3>例：</h3>
    <pre>
サンプル日記
今日は○○をしました。以上。
    </pre>
    <p>この状態で「Ctrl+S」を押すと、<strong>「20250312_サンプル日記.txt」</strong> というファイル名で保存されます。</p>
    
    <h2>手順</h2>
    <p>この機能を実現するには、サクラエディタの <strong>マクロ機能</strong> を利用します。</p>
    
    <h3>1. マクロファイルを作成する</h3>
    <ol>
        <li>「マクロ」→「マクロの設定」 を開く</li>
        <li>「新規作成」を選択し、適当な名前を付ける（例：「AutoSave.js」）</li>
        <li>以下のスクリプトをコピーして貼り付け、保存する</li>
    </ol>
    <pre>
// 日付を取得
var date = new Date();
var year = date.getFullYear();
var month = ("0" + (date.getMonth() + 1)).slice(-2);
var day = ("0" + date.getDate()).slice(-2);
var today = year + month + day;

// 1行目を取得（空白を削除）
var firstLine = document.GetLineStr(0).trim();
if (!firstLine) {
    firstLine = "無題"; // 1行目が空なら「無題」にする
}

// ファイル名を生成
var fileName = today + "_" + firstLine + ".txt";

// ファイルを新しい名前で保存
document.SaveAs(fileName);
    </pre>
    
    <h3>2. ショートカットキーを設定する</h3>
    <ol>
        <li>「設定」→「キー割り当て」 を開く</li>
        <li>「ユーザーマクロ」の一覧から、作成したマクロ（例：「AutoSave.js」）を選択</li>
        <li>「割り当てるキー」に <strong>「Ctrl+S」</strong> を設定</li>
        <li>「OK」を押して適用</li>
    </ol>
    
    <h2>まとめ</h2>
    <p>これで「Ctrl+S」を押すだけで、<strong>「日付＋1行目の文字列.txt」</strong> の形式で簡単に保存できるようになります。</p>
    <p>マクロを利用することで、作業の効率化が図れるので、ぜひ試してみてください！</p>
    
    <p>（参考：Qiitaの記事 <a href="https://qiita.com/forestysk/items/5322bf2a069d946c0170">https://qiita.com/forestysk/items/5322bf2a069d946c0170</a>）</p>
    <button class="privacy-back-button" 
    onclick="window.location.href='../index.html'">戻る</button>
</body>
</html>

